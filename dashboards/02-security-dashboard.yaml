views:
  ###############################################################################
  # SECURITY DASHBOARD
  # Cameras, alarm, locks, presence, door sensors
  ###############################################################################

  - title: Security
    path: security
    icon: mdi:shield-home

    type: sections
    max_columns: 3

    sections:
      # ===========================================================================
      # ALARM CONTROL
      # ===========================================================================
      - type: grid
        title: Alarm System
        cards:
          - type: custom:mushroom-alarm-control-panel-card
            entity: alarm_control_panel.home_alarm
            states:
              - armed_away
              - armed_home
              - armed_night
            show_keypad: true
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(22, 163, 74, 0.05) 100%);
                  border: 1px solid rgba(34, 197, 94, 0.2);
                }

          - type: custom:mushroom-template-card
            primary: >
              {% set state = states('alarm_control_panel.home_alarm') %}
              {% if state == 'disarmed' %}Disarmed
              {% elif state == 'armed_away' %}Armed Away
              {% elif state == 'armed_home' %}Armed Home
              {% elif state == 'armed_night' %}Armed Night
              {% else %}{{ state | title }}{% endif %}
            secondary: >
              {% if is_state('binary_sensor.safe_to_arm_alarm', 'on') %}
                Safe to arm fully
              {% else %}
                {% set reasons = [] %}
                {% if is_state('person.edward_eidam', 'home') %}{% set reasons = reasons + ['Edward home'] %}{% endif %}
                {% if is_state('person.loretta_eidam', 'home') %}{% set reasons = reasons + ['Loretta home'] %}{% endif %}
                {% if is_state('input_boolean.dogs_are_out', 'off') %}{% set reasons = reasons + ['Dogs home'] %}{% endif %}
                {{ reasons | join(' â€¢ ') }}
              {% endif %}
            icon: >
              {% if is_state('alarm_control_panel.home_alarm', 'disarmed') %}mdi:shield-off
              {% else %}mdi:shield-check{% endif %}
            icon_color: >
              {% if is_state('alarm_control_panel.home_alarm', 'disarmed') %}grey
              {% elif is_state('alarm_control_panel.home_alarm', 'armed_away') %}red
              {% else %}green{% endif %}

      # ===========================================================================
      # PRESENCE
      # ===========================================================================
      - type: grid
        title: Presence
        cards:
          - type: custom:mushroom-person-card
            entity: person.edward_eidam
            icon_type: entity-picture
            layout: horizontal

          - type: custom:mushroom-person-card
            entity: person.loretta_eidam
            icon_type: entity-picture
            layout: horizontal

          - type: custom:mushroom-template-card
            primary: Ankii (Nanny)
            secondary: "{% if is_state('binary_sensor.nanny_scheduled', 'on') %}Working â€¢ 08:00-17:30{% else %}Off duty{% endif %}"
            icon: mdi:account-clock
            icon_color: "{% if is_state('binary_sensor.nanny_scheduled', 'on') %}green{% else %}grey{% endif %}"

          - type: custom:mushroom-entity-card
            entity: input_boolean.dogs_are_out
            name: Dogs Status
            icon: mdi:dog
            tap_action:
              action: toggle
            secondary_info: >
              {% if is_state('input_boolean.dogs_are_out', 'on') %}Out for walk{% else %}At home{% endif %}

      # ===========================================================================
      # CAMERAS - LIVE FEEDS
      # ===========================================================================
      - type: grid
        title: Cameras
        cards:
          - type: picture-entity
            entity: camera.upstairs
            name: Front Door
            show_state: false
            camera_view: live

          - type: picture-entity
            entity: camera.basement_door
            name: Basement Door
            show_state: false
            camera_view: live

          - type: picture-entity
            entity: camera.lounge
            name: Lounge
            show_state: false
            camera_view: live

          - type: picture-entity
            entity: camera.lucas_s_room
            name: Lucas's Room
            show_state: false
            camera_view: live

          - type: picture-entity
            entity: camera.bedroom
            name: Bedroom
            show_state: false
            camera_view: live

          - type: picture-entity
            entity: camera.garden
            name: Garden
            show_state: false
            camera_view: live

      # ===========================================================================
      # CAMERA BATTERIES
      # ===========================================================================
      - type: grid
        title: Camera Batteries
        cards:
          - type: custom:mushroom-template-card
            primary: Front Door
            secondary: "{{ states('sensor.upstairs_battery') }}%"
            icon: "{% set lvl = states('sensor.upstairs_battery') | int %}{% if lvl > 50 %}mdi:battery{% elif lvl > 20 %}mdi:battery-50{% else %}mdi:battery-alert{% endif %}"
            icon_color: "{% set lvl = states('sensor.upstairs_battery') | int %}{% if lvl > 50 %}green{% elif lvl > 20 %}orange{% else %}red{% endif %}"

          - type: custom:mushroom-template-card
            primary: Basement Door
            secondary: "{{ states('sensor.basement_door_battery') }}%"
            icon: "{% set lvl = states('sensor.basement_door_battery') | int %}{% if lvl > 50 %}mdi:battery{% elif lvl > 20 %}mdi:battery-50{% else %}mdi:battery-alert{% endif %}"
            icon_color: "{% set lvl = states('sensor.basement_door_battery') | int %}{% if lvl > 50 %}green{% elif lvl > 20 %}orange{% else %}red{% endif %}"

          - type: custom:mushroom-template-card
            primary: Garden
            secondary: "{{ states('sensor.garden_battery') }}%"
            icon: "{% set lvl = states('sensor.garden_battery') | int %}{% if lvl > 50 %}mdi:battery{% elif lvl > 20 %}mdi:battery-50{% else %}mdi:battery-alert{% endif %}"
            icon_color: "{% set lvl = states('sensor.garden_battery') | int %}{% if lvl > 50 %}green{% elif lvl > 20 %}orange{% else %}red{% endif %}"
            card_mod:
              style: |
                ha-card {
                  {% if states('sensor.garden_battery') | int < 20 %}
                  background: rgba(239, 68, 68, 0.2);
                  border: 1px solid rgba(239, 68, 68, 0.5);
                  {% endif %}
                }

          - type: custom:mushroom-template-card
            primary: Basement Stairs
            secondary: "{{ states('sensor.basement_stairs_battery') }}%"
            icon: "{% set lvl = states('sensor.basement_stairs_battery') | int %}{% if lvl > 50 %}mdi:battery{% elif lvl > 20 %}mdi:battery-50{% else %}mdi:battery-alert{% endif %}"
            icon_color: "{% set lvl = states('sensor.basement_stairs_battery') | int %}{% if lvl > 50 %}green{% elif lvl > 20 %}orange{% else %}red{% endif %}"
            card_mod:
              style: |
                ha-card {
                  {% if states('sensor.basement_stairs_battery') | int < 30 %}
                  background: rgba(249, 115, 22, 0.2);
                  border: 1px solid rgba(249, 115, 22, 0.5);
                  {% endif %}
                }

          - type: custom:mushroom-template-card
            primary: Lounge
            secondary: "Wired"
            icon: mdi:power-plug
            icon_color: green

          - type: custom:mushroom-template-card
            primary: Lucas's Room
            secondary: "Wired"
            icon: mdi:power-plug
            icon_color: green

          - type: custom:mushroom-template-card
            primary: Bedroom
            secondary: "Wired"
            icon: mdi:power-plug
            icon_color: green

      # ===========================================================================
      # ACCESS CONTROL
      # ===========================================================================
      - type: grid
        title: Access Control
        cards:
          - type: custom:mushroom-lock-card
            entity: lock.lobby_lock
            name: Lobby Lock
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
                  border: 1px solid rgba(59, 130, 246, 0.2);
                }

          - type: custom:mushroom-entity-card
            entity: binary_sensor.basement_door_ding
            name: Doorbell
            icon: mdi:doorbell-video

      # ===========================================================================
      # DOOR SENSORS
      # ===========================================================================
      - type: grid
        title: Door Sensors
        cards:
          - type: custom:mushroom-template-card
            primary: Office Hallway
            secondary: "{% if is_state('binary_sensor.office_hallway_door', 'on') %}Open{% else %}Closed{% endif %}"
            icon: mdi:door
            icon_color: "{% if is_state('binary_sensor.office_hallway_door', 'on') %}orange{% else %}green{% endif %}"

          - type: custom:mushroom-template-card
            primary: Laundry
            secondary: "{% if is_state('binary_sensor.laundry_door', 'on') %}Open{% else %}Closed{% endif %}"
            icon: mdi:door
            icon_color: "{% if is_state('binary_sensor.laundry_door', 'on') %}orange{% else %}green{% endif %}"

          - type: custom:mushroom-template-card
            primary: Upstairs Entrance
            secondary: "{% if is_state('binary_sensor.upstairs_door', 'on') %}Open{% else %}Closed{% endif %}"
            icon: mdi:door
            icon_color: "{% if is_state('binary_sensor.upstairs_door', 'on') %}orange{% else %}green{% endif %}"

          - type: custom:mushroom-template-card
            primary: Cloakroom
            secondary: "{% if is_state('binary_sensor.cloakroom_door', 'on') %}Open{% else %}Closed{% endif %}"
            icon: mdi:door
            icon_color: "{% if is_state('binary_sensor.cloakroom_door', 'on') %}orange{% else %}green{% endif %}"

      # ===========================================================================
      # MOTION SENSORS
      # ===========================================================================
      - type: grid
        title: Motion Sensors
        cards:
          - type: custom:mushroom-entity-card
            entity: binary_sensor.entrance_motion_sensor_motion
            name: Entrance
            icon: mdi:motion-sensor

          - type: custom:mushroom-entity-card
            entity: binary_sensor.office_motion_sensor_motion
            name: Office
            icon: mdi:motion-sensor

      # ===========================================================================
      # RECENT ACTIVITY
      # ===========================================================================
      - type: grid
        title: Recent Activity
        cards:
          - type: logbook
            entities:
              - lock.lobby_lock
              - alarm_control_panel.home_alarm
              - binary_sensor.basement_door_ding
            hours_to_show: 24

###############################################################################
# LUCAS'S ROOM DASHBOARD — V3 SECTIONS LAYOUT
# Premium child-focused: camera, climate, routines, music
# Uses sections layout (same as Overview dashboard) for reliable rendering
# Requires: mushroom-cards, card-mod, button-card (HACS)
###############################################################################

title: Lucas's Room
path: lucas-room
icon: mdi:baby-face-outline
subview: true

type: sections
max_columns: 3

sections:
  # =====================================================================
  # HEADER — Status chips
  # =====================================================================
  - type: grid
    cards:
      - type: custom:mushroom-chips-card
        chips:
          - type: back
          - type: template
            icon: mdi:baby-face-outline
            content: "Lucas's Room"
            icon_color: cyan
          - type: template
            icon: mdi:thermometer
            content: "{{ states('sensor.lucas_room_temp_temperature') | round(1) }}°C"
            icon_color: >
              {% set temp = states('sensor.lucas_room_temp_temperature') | float(0) %}
              {% if temp < 18 %}blue{% elif temp > 23 %}red{% else %}green{% endif %}
          - type: template
            icon: mdi:water-percent
            content: "{{ states('sensor.lucas_room_temp_humidity') | round(0) }}%"
            icon_color: >
              {% set h = states('sensor.lucas_room_temp_humidity') | float(0) %}
              {% if h < 45 %}amber{% elif h > 55 %}blue{% else %}green{% endif %}
          - type: template
            icon: mdi:bathtub
            content: "Bath {{ states('sensor.lucas_bath_temp_sensor_temperature') | round(0) }}°C"
            icon_color: cyan
          - type: entity
            entity: input_boolean.lucas_napping
            icon: mdi:sleep
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, rgba(6, 182, 212, 0.12) 0%, rgba(59, 130, 246, 0.06) 100%);
              border: 1px solid rgba(6, 182, 212, 0.2);
              border-radius: 16px !important;
            }

  # =====================================================================
  # NAPPING MODE — Full width accent
  # =====================================================================
  - type: grid
    cards:
      - type: custom:mushroom-entity-card
        entity: input_boolean.lucas_napping
        name: "Napping Mode — Silences doorbell, dims lights"
        icon: mdi:sleep
        tap_action:
          action: toggle
        card_mod:
          style: |
            ha-card {
              border-radius: 16px !important;
              {% if is_state('input_boolean.lucas_napping', 'on') %}
              background: linear-gradient(135deg, rgba(99, 102, 241, 0.3) 0%, rgba(139, 92, 246, 0.12) 100%);
              border: 2px solid rgba(99, 102, 241, 0.5);
              box-shadow: 0 0 20px rgba(99, 102, 241, 0.15);
              {% else %}
              background: linear-gradient(135deg, rgba(99, 102, 241, 0.06) 0%, transparent 100%);
              border: 1px solid rgba(99, 102, 241, 0.12);
              {% endif %}
            }

  # =====================================================================
  # CAMERA + ENVIRONMENT
  # =====================================================================
  - type: grid
    title: ""
    column_span: 2
    cards:
      - type: picture-entity
        entity: camera.lucass_room_snapshot
        name: ""
        show_state: false
        show_name: false
        camera_view: live
        card_mod:
          style: |
            ha-card {
              border-radius: 20px !important;
              overflow: hidden;
              border: 2px solid rgba(6, 182, 212, 0.25);
              box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
              aspect-ratio: 16/9;
            }

  - type: grid
    title: Environment
    column_span: 1
    cards:
      # Temperature
      - type: custom:mushroom-template-card
        primary: Temperature
        secondary: "{{ states('sensor.lucas_room_temp_temperature') | round(1) }}°C"
        icon: mdi:thermometer
        icon_color: >
          {% set temp = states('sensor.lucas_room_temp_temperature') | float(0) %}
          {% if temp < 18 %}blue{% elif temp > 23 %}red{% else %}green{% endif %}
        card_mod:
          style: |
            ha-card {
              border-radius: 16px !important;
              {% set temp = states('sensor.lucas_room_temp_temperature') | float(0) %}
              {% if temp >= 18 and temp <= 23 %}
              background: linear-gradient(135deg, rgba(34, 197, 94, 0.18) 0%, rgba(16, 185, 129, 0.06) 100%);
              border: 1px solid rgba(34, 197, 94, 0.3);
              {% elif temp < 18 %}
              background: linear-gradient(135deg, rgba(59, 130, 246, 0.18) 0%, rgba(99, 102, 241, 0.06) 100%);
              border: 1px solid rgba(59, 130, 246, 0.3);
              {% else %}
              background: linear-gradient(135deg, rgba(239, 68, 68, 0.18) 0%, rgba(249, 115, 22, 0.06) 100%);
              border: 1px solid rgba(239, 68, 68, 0.3);
              {% endif %}
            }

      # Humidity
      - type: custom:mushroom-template-card
        primary: Humidity
        secondary: "{{ states('sensor.lucas_room_temp_humidity') | round(0) }}%"
        icon: mdi:water-percent
        icon_color: >
          {% set h = states('sensor.lucas_room_temp_humidity') | float(0) %}
          {% if h < 45 %}amber{% elif h > 55 %}blue{% else %}green{% endif %}
        card_mod:
          style: |
            ha-card {
              border-radius: 16px !important;
              {% set h = states('sensor.lucas_room_temp_humidity') | float(0) %}
              {% if h >= 45 and h <= 55 %}
              background: linear-gradient(135deg, rgba(34, 197, 94, 0.18) 0%, rgba(16, 185, 129, 0.06) 100%);
              border: 1px solid rgba(34, 197, 94, 0.3);
              {% else %}
              background: linear-gradient(135deg, rgba(249, 115, 22, 0.18) 0%, rgba(245, 158, 11, 0.06) 100%);
              border: 1px solid rgba(249, 115, 22, 0.3);
              {% endif %}
            }

      # Heating
      - type: custom:mushroom-climate-card
        entity: climate.lucas_s_room
        name: Heating
        show_temperature_control: true
        collapsible_controls: true
        card_mod:
          style: |
            ha-card {
              border-radius: 16px !important;
              background: linear-gradient(135deg, rgba(251, 146, 60, 0.14) 0%, rgba(234, 88, 12, 0.04) 100%);
              border: 1px solid rgba(251, 146, 60, 0.25);
            }

  # =====================================================================
  # ROUTINES — Quick action buttons
  # =====================================================================
  - type: grid
    title: Routines
    cards:
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            name: Morning
            icon: mdi:weather-sunny
            color: rgb(245, 158, 11)
            styles:
              card:
                - background: "linear-gradient(145deg, rgba(245, 158, 11, 0.22) 0%, rgba(234, 88, 12, 0.06) 100%)"
                - border: "1px solid rgba(245, 158, 11, 0.3)"
                - border-radius: 18px
                - padding: 20px 6px
                - box-shadow: "0 4px 16px rgba(245, 158, 11, 0.08)"
              icon:
                - width: 36px
                - color: rgb(245, 158, 11)
              name:
                - font-size: 12px
                - font-weight: 600
                - color: rgba(255, 255, 255, 0.9)
                - margin-top: 8px
            tap_action:
              action: call-service
              service: script.lucas_morning_routine

          - type: custom:button-card
            name: Bathtime
            icon: mdi:bathtub
            color: rgb(6, 182, 212)
            styles:
              card:
                - background: "linear-gradient(145deg, rgba(6, 182, 212, 0.22) 0%, rgba(59, 130, 246, 0.06) 100%)"
                - border: "1px solid rgba(6, 182, 212, 0.3)"
                - border-radius: 18px
                - padding: 20px 6px
                - box-shadow: "0 4px 16px rgba(6, 182, 212, 0.08)"
              icon:
                - width: 36px
                - color: rgb(6, 182, 212)
              name:
                - font-size: 12px
                - font-weight: 600
                - color: rgba(255, 255, 255, 0.9)
                - margin-top: 8px
            tap_action:
              action: call-service
              service: script.lucas_bathtime

          - type: custom:button-card
            name: Wind Down
            icon: mdi:weather-sunset
            color: rgb(249, 115, 22)
            styles:
              card:
                - background: "linear-gradient(145deg, rgba(249, 115, 22, 0.22) 0%, rgba(234, 88, 12, 0.06) 100%)"
                - border: "1px solid rgba(249, 115, 22, 0.3)"
                - border-radius: 18px
                - padding: 20px 6px
                - box-shadow: "0 4px 16px rgba(249, 115, 22, 0.08)"
              icon:
                - width: 36px
                - color: rgb(249, 115, 22)
              name:
                - font-size: 12px
                - font-weight: 600
                - color: rgba(255, 255, 255, 0.9)
                - margin-top: 8px
            tap_action:
              action: call-service
              service: script.lucas_wind_down

          - type: custom:button-card
            name: Bedtime
            icon: mdi:bed
            color: rgb(99, 102, 241)
            styles:
              card:
                - background: "linear-gradient(145deg, rgba(99, 102, 241, 0.22) 0%, rgba(129, 140, 248, 0.06) 100%)"
                - border: "1px solid rgba(99, 102, 241, 0.3)"
                - border-radius: 18px
                - padding: 20px 6px
                - box-shadow: "0 4px 16px rgba(99, 102, 241, 0.08)"
              icon:
                - width: 36px
                - color: rgb(99, 102, 241)
              name:
                - font-size: 12px
                - font-weight: 600
                - color: rgba(255, 255, 255, 0.9)
                - margin-top: 8px
            tap_action:
              action: call-service
              service: script.lucas_bedtime

          - type: custom:button-card
            name: Nightlight
            icon: mdi:lightbulb-night
            color: rgb(251, 191, 36)
            styles:
              card:
                - background: "linear-gradient(145deg, rgba(251, 191, 36, 0.18) 0%, rgba(245, 158, 11, 0.05) 100%)"
                - border: "1px solid rgba(251, 191, 36, 0.25)"
                - border-radius: 18px
                - padding: 20px 6px
              icon:
                - width: 36px
                - color: rgb(251, 191, 36)
              name:
                - font-size: 12px
                - font-weight: 600
                - color: rgba(255, 255, 255, 0.9)
                - margin-top: 8px
            tap_action:
              action: call-service
              service: script.lucas_nightlight

###############################################################################
# DECLUTTERING TEMPLATES
# Reusable card components for Eidam Smart Home
# Install decluttering-card via HACS first
###############################################################################

#==============================================================================
# ROOM STATUS CHIPS
# Standard temperature/humidity chips for room headers
#==============================================================================
room_status_chips:
  card:
    type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: mdi:thermometer
        content: "{{ states('[[temp_sensor]]') }}°C"
        icon_color: >
          {% set temp = states('[[temp_sensor]]') | float %}
          {% if temp < 18 %}blue{% elif temp > 23 %}red{% else %}green{% endif %}
      - type: template
        icon: mdi:water-percent
        content: "{{ states('[[humidity_sensor]]') }}%"
        icon_color: >
          {% set hum = states('[[humidity_sensor]]') | float %}
          {% if hum < 40 %}amber{% elif hum > 60 %}blue{% else %}green{% endif %}

# With media player chip
room_status_chips_media:
  card:
    type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: mdi:thermometer
        content: "{{ states('[[temp_sensor]]') }}°C"
        icon_color: >
          {% set temp = states('[[temp_sensor]]') | float %}
          {% if temp < 18 %}blue{% elif temp > 23 %}red{% else %}green{% endif %}
      - type: template
        icon: mdi:water-percent
        content: "{{ states('[[humidity_sensor]]') }}%"
        icon_color: >
          {% set hum = states('[[humidity_sensor]]') | float %}
          {% if hum < 40 %}amber{% elif hum > 60 %}blue{% else %}green{% endif %}
      - type: entity
        entity: "[[media_player]]"
        icon: mdi:speaker
        content_info: state

# Lucas room - tighter temperature range (18-21°C ideal for babies)
lucas_status_chips:
  card:
    type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: mdi:thermometer
        content: "{{ states('[[temp_sensor]]') }}°C"
        icon_color: >
          {% set temp = states('[[temp_sensor]]') | float %}
          {% if temp < 18 %}blue{% elif temp > 22 %}red{% else %}green{% endif %}
      - type: template
        icon: mdi:water-percent
        content: "{{ states('[[humidity_sensor]]') }}%"
        icon_color: >
          {% set hum = states('[[humidity_sensor]]') | float %}
          {% if hum < 40 %}amber{% elif hum > 60 %}blue{% else %}green{% endif %}
      - type: template
        icon: mdi:bathtub
        content: "Bath: {{ states('[[bath_sensor]]') }}°C"
        icon_color: cyan
      - type: entity
        entity: "[[camera]]"
        icon: mdi:camera
        content_info: none

#==============================================================================
# CLIMATE CARDS
# Thermostat + temperature/humidity sensors
#==============================================================================
climate_card:
  card:
    type: custom:mushroom-climate-card
    entity: "[[climate_entity]]"
    name: Heating
    show_temperature_control: true
    hvac_modes:
      - auto
      - heat
      - "off"
    collapsible_controls: true

temperature_card:
  card:
    type: custom:mushroom-entity-card
    entity: "[[temp_sensor]]"
    name: Temperature
    icon: mdi:thermometer
    primary_info: state
    secondary_info: name

humidity_card:
  card:
    type: custom:mushroom-entity-card
    entity: "[[humidity_sensor]]"
    name: Humidity
    icon: mdi:water-percent
    primary_info: state
    secondary_info: name

# Temperature graph - 24 hour view
temperature_graph:
  default:
    - color: "#ff9800"
    - name: Temperature
  card:
    type: custom:mini-graph-card
    name: Temperature (24h)
    entities:
      - entity: "[[temp_sensor]]"
        name: "[[name]]"
        color: "[[color]]"
    hours_to_show: 24
    points_per_hour: 4
    line_width: 2
    show:
      labels: true
      points: false
      legend: false

#==============================================================================
# LIGHTING CARDS
#==============================================================================
light_group_card:
  default:
    - show_color: true
  card:
    type: custom:mushroom-light-card
    entity: "[[light_entity]]"
    name: "[[name]]"
    icon: mdi:lightbulb-group
    show_brightness_control: true
    show_color_control: "[[show_color]]"
    use_light_color: true
    collapsible_controls: true

light_card:
  default:
    - show_color: false
    - icon: mdi:lightbulb
  card:
    type: custom:mushroom-light-card
    entity: "[[light_entity]]"
    name: "[[name]]"
    icon: "[[icon]]"
    show_brightness_control: true
    show_color_control: "[[show_color]]"
    use_light_color: true
    collapsible_controls: true

#==============================================================================
# SCENE BUTTONS
# Single scene button for horizontal stacks
#==============================================================================
scene_button:
  card:
    type: custom:mushroom-template-card
    primary: "[[name]]"
    icon: "[[icon]]"
    icon_color: "[[color]]"
    tap_action:
      action: call-service
      service: scene.turn_on
      target:
        entity_id: "[[scene_entity]]"
    layout: vertical

# Scene button row - 4 scenes in a row
scene_row_4:
  card:
    type: horizontal-stack
    cards:
      - type: custom:mushroom-template-card
        primary: "[[scene_1_name]]"
        icon: "[[scene_1_icon]]"
        icon_color: "[[scene_1_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_1_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "[[scene_2_name]]"
        icon: "[[scene_2_icon]]"
        icon_color: "[[scene_2_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_2_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "[[scene_3_name]]"
        icon: "[[scene_3_icon]]"
        icon_color: "[[scene_3_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_3_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "[[scene_4_name]]"
        icon: "[[scene_4_icon]]"
        icon_color: "[[scene_4_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_4_entity]]"
        layout: vertical

# Scene row with lights off button
scene_row_with_off:
  card:
    type: horizontal-stack
    cards:
      - type: custom:mushroom-template-card
        primary: "[[scene_1_name]]"
        icon: "[[scene_1_icon]]"
        icon_color: "[[scene_1_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_1_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "[[scene_2_name]]"
        icon: "[[scene_2_icon]]"
        icon_color: "[[scene_2_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_2_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "[[scene_3_name]]"
        icon: "[[scene_3_icon]]"
        icon_color: "[[scene_3_color]]"
        tap_action:
          action: call-service
          service: scene.turn_on
          target:
            entity_id: "[[scene_3_entity]]"
        layout: vertical
      - type: custom:mushroom-template-card
        primary: "Off"
        icon: mdi:lightbulb-off
        icon_color: grey
        tap_action:
          action: call-service
          service: light.turn_off
          target:
            entity_id: "[[light_group]]"
        layout: vertical

#==============================================================================
# DEVICE / SWITCH CARDS
#==============================================================================
device_switch:
  card:
    type: custom:mushroom-entity-card
    entity: "[[switch_entity]]"
    name: "[[name]]"
    icon: "[[icon]]"
    tap_action:
      action: toggle

#==============================================================================
# CAMERA CARDS
#==============================================================================
camera_card:
  default:
    - show_name: true
  card:
    type: picture-entity
    entity: "[[camera_entity]]"
    name: "[[name]]"
    show_state: false
    show_name: "[[show_name]]"
    camera_view: live

#==============================================================================
# MEDIA PLAYER CARDS
#==============================================================================
media_player_mini:
  default:
    - artwork: cover
  card:
    type: custom:mini-media-player
    entity: "[[media_entity]]"
    name: "[[name]]"
    artwork: "[[artwork]]"
    source: icon
    sound_mode: icon
    info: scroll
    volume_stateless: false

media_player_mushroom:
  card:
    type: custom:mushroom-media-player-card
    entity: "[[media_entity]]"
    name: "[[name]]"
    use_media_info: true
    show_volume_level: true
    media_controls:
      - play_pause_stop
      - previous
      - next
    volume_controls:
      - volume_buttons
      - volume_mute
    collapsible_controls: true

#==============================================================================
# LUCAS QUICK ACTION BUTTONS
# Large touch-friendly buttons for routines
#==============================================================================
lucas_quick_action:
  card:
    type: custom:mushroom-template-card
    primary: "[[title]]"
    secondary: "[[subtitle]]"
    icon: "[[icon]]"
    icon_color: "[[color]]"
    layout: vertical
    fill_container: true
    tap_action:
      action: call-service
      service: scene.turn_on
      target:
        entity_id: "[[scene_entity]]"

#==============================================================================
# HOUSE STATE CHIP
# Shows current house mode in overview dashboard
#==============================================================================
house_state_chip:
  card:
    type: custom:mushroom-chips-card
    chips:
      - type: template
        entity: input_select.house_state
        icon: >
          {% set state = states('input_select.house_state') %}
          {% if state == 'Away' %}mdi:home-export-outline
          {% elif state == 'Quiet' %}mdi:volume-off
          {% elif state == 'Meeting' %}mdi:video
          {% elif state == 'Night' %}mdi:weather-night
          {% elif state == 'Guest' %}mdi:account-group
          {% else %}mdi:home{% endif %}
        content: "{{ states('input_select.house_state') }}"
        icon_color: >
          {% set state = states('input_select.house_state') %}
          {% if state == 'Away' %}grey
          {% elif state == 'Quiet' %}purple
          {% elif state == 'Meeting' %}red
          {% elif state == 'Night' %}blue
          {% elif state == 'Guest' %}amber
          {% else %}green{% endif %}
        tap_action:
          action: more-info

#==============================================================================
# LUCAS ROOM STATE CHIP
# Shows current state of Lucas's room
#==============================================================================
lucas_state_chip:
  card:
    type: custom:mushroom-chips-card
    chips:
      - type: template
        entity: input_select.lucas_room_state
        icon: >
          {% set state = states('input_select.lucas_room_state') %}
          {% if state == 'Sleeping' %}mdi:sleep
          {% elif state == 'Napping' %}mdi:power-sleep
          {% elif state == 'Wind Down' %}mdi:weather-sunset
          {% elif state == 'Bathtime' %}mdi:bathtub
          {% else %}mdi:baby-face{% endif %}
        content: "{{ states('input_select.lucas_room_state') }}"
        icon_color: >
          {% set state = states('input_select.lucas_room_state') %}
          {% if state == 'Sleeping' %}purple
          {% elif state == 'Napping' %}indigo
          {% elif state == 'Wind Down' %}orange
          {% elif state == 'Bathtime' %}cyan
          {% else %}green{% endif %}
        tap_action:
          action: call-service
          service: input_select.select_next
          target:
            entity_id: input_select.lucas_room_state

#==============================================================================
# APPLIANCE CARDS
#==============================================================================
appliance_card:
  card:
    type: custom:mushroom-template-card
    primary: "[[name]]"
    secondary: "[[secondary_template]]"
    icon: "[[icon]]"
    icon_color: "[[icon_color_template]]"
    tap_action:
      action: more-info
      entity: "[[entity]]"
